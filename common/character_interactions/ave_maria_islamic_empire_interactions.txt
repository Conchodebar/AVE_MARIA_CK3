########################################################################################
#                                         											   #
# AVE MARIA Characters Interactions													   #
# A Very Extensive Modification for Appropriate Realism and Improved Authenticity	   #
#                                         											   #
# Islamic Empire Characters Interactions   		          							   #
#                               													   #
########################################################################################

## Written by Atreides

islamic_empire_name_qadi = {
	category = interaction_category_vassal

	use_diplomatic_range = yes

	is_shown = {
		scope:actor = {
			uses_islamic_empire_govt = yes
			highest_held_title_tier >= tier_empire 
		}
		scope:recipient = { 
			highest_held_title_tier >= tier_duchy 
			NOR = {
				has_government = theocracy_government
				has_government = feudal_government
				has_government = clan_government
				has_government = tribal_government
			}		
			uses_islamic_empire_govt = yes		
		}
	}

	auto_accept = yes
	
	ai_potential = {
		always = yes
	}

	populate_recipient_list = {
		scope:actor = {
			every_courtier = {
				limit = {
					is_female = no
					age >= 18
					learning >= 12
					faith = faith:ismaili
				}
				add_to_list = characters
			}
		}
	}

	on_accept = {
		scope:recipient = {
			if = {
				limit = {
					exists = cp:councillor_chancellor
				}
				fire_councillor = cp:councillor_chancellor
				assign_councillor_type = {
					type = councillor_chancellor
					target = scope:secondary_recipient
				}
			}
		}
		scope:secondary_recipient = {
			add_opinion = {
				target = scope:actor
				modifier = roman_administration_favoured_me
				opinion = 25
			}
		}
	}


	ai_targets = {
		ai_recipients = vassals
		max = 20
	}

	ai_frequency = 24

	ai_will_do = {
		base = 0
		
		modifier = {
			add = 100
			scope:recipient = {
				OR = {
					has_relation_rival = scope:actor
					has_relation_nemesis = scope:actor
				}
			}
		}
		
		modifier = {
			add = 100
			scope:recipient = {
				is_primary_heir_of = scope:actor
				OR = {
					has_trait = inbred
					has_trait = intellect_bad_3
					has_trait = incapable
				}
			}
		}
		
		modifier = {
			add = 5
			ai_vengefulness >= medium_positive_ai_value
			scope:recipient = {
				is_heir_of = scope:actor
			}
			OR = {
				AND = {
					scope:recipient = {
						has_trait = incestuous
					}
					NOT = { is_incestuous_trigger = yes }
					trait_is_criminal_in_faith_trigger = { TRAIT = incestuous FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = kinslayer
					}
					NOT = { has_trait = kinslayer }
				}
				AND = {
					scope:recipient = {
						has_trait = adulterer
					}
					NOR = {
						has_trait = adulterer
						has_trait = fornicator
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = adulterer FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = fornicator
					}
					NOR = {
						has_trait = adulterer
						has_trait = fornicator
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = fornicator FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = deviant
					}
					NOT = {
						is_deviant_trigger = yes
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = deviant FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = witch
					}
					NOT = {
						is_witch_trigger = yes
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = witch FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = sodomite
					}
					NOR = {
						has_trait = sodomite
						any_secret = {
							secret_type = secret_homosexual
						}
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = sodomite FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
				AND = {
					scope:recipient = {
						has_trait = cannibal
					}
					NOT = {
						is_cannibal_trigger = yes
					}
					trait_is_criminal_in_faith_trigger = { TRAIT = cannibal FAITH = scope:actor.faith GENDER_CHARACTER = scope:recipient }
				}
			}
		}
		
		modifier = {
			factor = 0
			scope:recipient = {
				OR = {
					has_relation_friend = scope:actor
					has_relation_best_friend = scope:actor
				}
			}
		}
		
		modifier = {
			factor = 0
			scope:recipient = {
				is_ai = no
			}
		}

		modifier = {
			add = 25
			scope:actor = {
				dynasty = {
					any_dynasty_member = {
						NOT = {
							this = scope:recipient
						}
					}
				}
				
			}
			scope:recipient = {
				any_held_title = {
					this = title:d_megas_domestikos
				}
			}
		}

		modifier = {
			add = -100
			scope:actor = {
				has_variable = roman_administration_popularity
				var:roman_administration_popularity <= 70
			}
		}
	}
}