# task_roman_administration_councillor_coemperor = {
# 	position = roman_councillor_coemperor
# 	default_task = yes
	
# 	task_type = task_type_general
# 	task_progress = task_progress_infinite
	
# 	effect_desc = task_advisor_1_default_effect_desc

# 	council_owner_modifier = {
# 		name = task_advisor_default_generic_modifier
# 		
# 		monthly_prestige = 0.01
# 	}

# }

coemperor_task_coemperor_default = {
	default_task = yes
	position = roman_councillor_coemperor

	effect_desc = coemperor_task_coemperor_default_desc

	task_type = task_type_general
	task_progress = task_progress_infinite

	council_owner_modifier = {
		name = task_coemperor_default_diplomacy_modifier
		diplomacy = 1
		scale = coemperor_default_task_diplomacy_scale
	}

	council_owner_modifier = {
		name = task_coemperor_default_martial_modifier
		martial = 1
		scale = coemperor_default_task_martial_scale
	}

	council_owner_modifier = {
		name = task_coemperor_default_stewardship_modifier
		stewardship = 1
		scale = coemperor_default_task_stewardship_scale
	}

	council_owner_modifier = {
		name = task_coemperor_default_intrigue_modifier
		intrigue = 1
		scale = coemperor_default_task_intrigue_scale
	}

	council_owner_modifier = {
		name = task_coemperor_default_learning_modifier
		learning = 1
		scale = coemperor_default_task_learning_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = coemperor_councillor_default_on_action
				days = { 0 30 }
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup
	}
}
coemperor_task_court_politics = {
	position = roman_councillor_coemperor

	skill = diplomacy
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = task_court_politics_effect_desc

	council_owner_modifier = {
		name = task_court_politics_modifier
		diplomacy = 1
		scale = coemperor_task_court_politics_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = court_politics_setup
				days = { 0 30 }
			}
		}
	}
}
coemperor_task_chivalry = {
	position = roman_councillor_coemperor

	skill = martial
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = task_chivalry_effect_desc

	council_owner_modifier = {
		name = task_chivalry_modifier
		martial = 1
		scale = coemperor_task_chivalry_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = chivalry_setup
				days = { 0 30 }
			}
		}
	}
}
coemperor_task_manage_domain = {
	position = roman_councillor_coemperor

	skill = stewardship
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = task_manage_domain_effect_desc

	council_owner_modifier = {
		name = task_manage_domain_modifier
		stewardship = 1
		scale = coemperor_task_manage_domain_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = manage_domain_setup
				days = { 0 30 }
			}
		}
	}
}
coemperor_task_court_intrigue = {
	position = roman_councillor_coemperor

	skill = intrigue
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = task_court_intrigue_effect_desc

	council_owner_modifier = {
		name = task_court_intrigue_modifier
		intrigue = 1
		scale = coemperor_task_court_intrigue_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = court_intrigue_setup
				days = { 0 30 }
			}
		}
	}
}
coemperor_task_patronage = {
	position = roman_councillor_coemperor

	skill = learning
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = task_patronage_effect_desc

	council_owner_modifier = {
		name = task_patronage_modifier
		learning = 1
		scale = coemperor_task_patronage_scale
	}

	on_monthly = {
		scope:councillor_liege = {
			trigger_event = {
				on_action = patronage_setup
				days = { 0 30 }
			}
		}
	}
}

ave_maria_task_court_life_protospatharios = {
	position = roman_dignities_protospatharios
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_1_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}
ave_maria_task_court_life_patrikios = {
	position = roman_dignities_patrikios
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_2_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}
ave_maria_task_court_life_anthypatos = {
	position = roman_dignities_anthypatos
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_3_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}
ave_maria_task_court_life_magistros = {
	position = roman_dignities_magistros
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_4_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}
ave_maria_task_court_life_vestarches = {
	position = roman_dignities_vestarches
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_5_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}
ave_maria_task_court_life_proedros = {
	position = roman_dignities_proedros
	default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = task_advisor_6_default_effect_desc

	council_owner_modifier = {
		name = task_advisor_default_generic_modifier
		
		monthly_prestige = 0.05
	}
}

synkellos_task_religious_relations = {
	default_task = yes
	position = roman_councillor_synkellos

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		### Piety tooltip
		desc = task_religious_relations_piety_effect_desc
		triggered_desc = {
			trigger = {
				scope:councillor_liege = { has_perk = clerical_justifications_perk }
			}
			desc = task_religious_relations_effect_desc_perk_bonus_piety
		}
		triggered_desc = {
			trigger = {
				scope:councillor_liege = {
					exists = dynasty
					dynasty = { has_dynasty_perk = erudition_legacy_5 }
				}
			}
			desc = task_religious_relations_effect_desc_legacy_bonus_piety
		}

		first_valid = {
			triggered_desc = { 
				trigger = {
					scope:councillor.faith = {
						OR = {
							has_doctrine_parameter = no_head_of_faith
							NOT = { exists = religious_head }
						}
						has_doctrine = doctrine_theocracy_lay_clergy
					}
				}
				desc = task_religious_relations_effect_no_hof_layman_clergy_desc_opinion
			}
			desc = task_religious_relations_effect_desc_opinion	
		}


		triggered_desc = {
			trigger = {
				scope:councillor_liege = {	has_perk = clerical_justifications_perk }
			}
			desc = task_religious_relations_effect_desc_perk_bonus_opinion
		}
		triggered_desc = {
			trigger = {
				scope:councillor_liege = {
					exists = dynasty
					dynasty = { has_dynasty_perk = erudition_legacy_5 }
				}
			}
			desc = task_religious_relations_effect_desc_legacy_bonus_opinion
		}
		desc = line_break

		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					learning > mediocre_skill_rating
				}
				desc = task_religious_relations_opinion_gain
			}
			triggered_desc = {
				trigger = {
					learning < high_skill_rating
				}
				desc = task_religious_relations_piety_loss
			}
			triggered_desc = {
				trigger = {
					learning < high_skill_rating
				}
				desc = task_religious_relations_opinion_loss
			}
		}
	}

	on_start_task = {
		set_variable = {
			name = court_chaplain_religious_relations_opinion_value
			value = 0
		}

		liege = {
			add_character_flag = {
				flag = no_court_chaplain_side_effects_first_month
				days = 30
			}
		}
	}

	on_cancel_task = {
		if = {
			limit = {
				is_alive = yes
				has_variable = court_chaplain_religious_relations_opinion_value
			}
			remove_variable = court_chaplain_religious_relations_opinion_value
		}
	}

	council_owner_modifier = {
		name = court_chaplain_religious_relations_modifier
		monthly_piety = 1
		scale = court_chaplain_religious_relations_modifier
	}

	council_owner_modifier = {
		name = court_chaplain_religious_relations_perk_bonus_modifier
		monthly_piety = 1
		scale = court_chaplain_religious_relations_perk_bonus_modifier
	}

	council_owner_modifier = {
		name = court_chaplain_religious_relations_erudition_legacy_5_bonus_modifier
		monthly_piety = 1
		scale = court_chaplain_religious_relations_erudition_legacy_5_bonus_modifier
	}

	council_owner_modifier = {
		name = court_chaplain_religious_relations_opinion_modifier
		theocracy_government_opinion_same_faith = 1
		scale = court_chaplain_religious_relations_opinion_modifier
	}

	council_owner_modifier = {
		name = court_chaplain_religious_relations_no_hof_opinion_modifier
		same_faith_opinion = 1
		scale = court_chaplain_religious_relations_no_hof_opinion_modifier
	}

	on_monthly = {
		if = {
			limit = {
				liege = { is_ai = no }
			}
			if = {
				limit = {
					liege = {
						has_variable = court_chaplain_religious_relations_opinion_value
					}
				}
				liege = {
					if = {
						limit = {
							var:court_chaplain_religious_relations_opinion_value < root.court_chaplain_religious_relations_opinion_max
						}
						change_variable = {
							name = court_chaplain_religious_relations_opinion_value
							add = root.court_chaplain_religious_relations_monthly_increase
						}
					}
					if = {
						limit = {
							var:court_chaplain_religious_relations_opinion_value > root.court_chaplain_religious_relations_opinion_max
						}
						set_variable = {
							name = court_chaplain_religious_relations_opinion_value
							value = root.court_chaplain_religious_relations_opinion_max
						}
					}
				}
			}
			else = {
				liege = {
					set_variable = {
						name = court_chaplain_religious_relations_opinion_value
						value = 0
					}
				}
			}
		}
		liege = {
			if = {
				limit = {
					has_character_flag = no_court_chaplain_side_effects_first_month
				}
				remove_character_flag = no_court_chaplain_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = task_religious_relations_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup

	}
}
synkellos_task_conversion = {
	position = roman_councillor_synkellos

	task_type = task_type_county
	county_target = realm
	ai_county_target = realm
	task_progress = task_progress_percentage
	highlight_own_realm = yes

	effect_desc = {
		desc = task_conversion_effect_desc
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					learning > mediocre_skill_rating
				}
				desc = task_conversion_opinion_gain
			}
			triggered_desc = {
				trigger = {
					learning > mediocre_skill_rating
				}
				desc = task_conversion_development_gain
			}
			triggered_desc = {
				trigger = {
					learning > mediocre_skill_rating
				}
				desc = task_conversion_levy_gain
			}
			triggered_desc = {
				trigger = {
					learning < high_skill_rating
				}
				desc = task_conversion_resistance_to_conversion
			}
			triggered_desc = {
				trigger = {
					learning < high_skill_rating
				}
				desc = task_conversion_opinion_loss
			}
		}
	}

	progress = {
		value = 0
		#Base conversion speed
		add = {
			value = court_chaplain_conversion_base
			desc = COURT_CHAPLAIN_PROGRESS_BASE
		}
		add = {
			value = scope:councillor.court_chaplain_conversion_monthly_increase
			desc = SCALED_COUNCILLOR_LEARNING_VALUE
		}
		#Fervor of Court Chaplain's Faith
		if = {
			limit = { # Conditional in order to not mess up the preview-tooltip
				exists = scope:county
				exists = scope:councillor.faith	
				exists = scope:county.faith
			}
			add = {
				add = {
					add = scope:councillor.court_chaplain_progress_percentage
					multiply = scope:councillor.faith.fervor
					multiply = convert_faith_fervor_modifier_scale
				}
				subtract = {
					add = scope:councillor.court_chaplain_progress_percentage
					multiply = scope:county.faith.fervor
					multiply = convert_faith_fervor_modifier_scale
				}
				if = {
					limit = {
						scope:councillor_liege = { has_perk = religious_icon_perk }
					}
					min = 0
				}
				desc = COURT_CHAPLAIN_CONVERSION_FERVOR_IMPACT
			}
		}
		#Perk Bonus
		if = {
			limit = {
				scope:councillor_liege = { has_perk = zealous_proselytizer_perk }
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_perk_bonus
				desc = CONVERSION_PERK_BONUS_VALUE
			}
		}
		if = {
			limit = {
				scope:councillor_liege = {
					exists = dynasty
					dynasty = { has_dynasty_perk = erudition_legacy_5 }
				}
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_dynasty_perk_bonus
				desc = CONVERSION_DYNASTY_PERK_BONUS_VALUE
			}
		}
		# Relation Bonuses/Penalties
		if = { # Friend
			limit = {
				scope:councillor_liege = {
					has_relation_friend = scope:councillor
					NOT = { has_relation_best_friend = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_friend_bonus
				desc = COUNCILLOR_IS_YOUR_FRIEND
			}
		}
		if = { # Best Friend
			limit = {
				scope:councillor_liege = {
					has_relation_best_friend = scope:councillor
				}
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_best_friend_bonus
				desc = COUNCILLOR_IS_YOUR_BEST_FRIEND
			}
		}
		if = { # Rival
			limit = {
				scope:councillor_liege = {
					has_relation_rival = scope:councillor
					NOT = { has_relation_nemesis = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_rival_bonus
				desc = COUNCILLOR_IS_YOUR_RIVAL
			}
		}
		if = { # Nemesis
			limit = {
				scope:councillor_liege = {
					has_relation_nemesis = scope:councillor
				}
			}
			add = {
				value = scope:councillor.court_chaplain_conversion_monthly_increase_nemesis_bonus
				desc = COUNCILLOR_IS_YOUR_NEMESIS
			}
		}
		#Conversion modifiers from where the Faith is on the Pluralism spectrum.
		if = {
			limit = {
				scope:councillor.faith = {
					has_doctrine_parameter = pluralism_fundamentalist_proselytization_bonus
				}
			}
			add = {
				value = scope:councillor.conversion_fundamentalist_faith_bonus
				desc = COURT_CHAPLAIN_CONVERSION_FUNDAMENTALIST_FAITH_BONUS
			}
		}
		if = {
			limit = {
				scope:councillor.faith = {
					has_doctrine_parameter = pluralism_pluralistic_proselytization_penalty
				}
			}
			add = {
				value = scope:councillor.conversion_pluralistic_faith_penalty
				desc = COURT_CHAPLAIN_CONVERSION_PLURALISTIC_FAITH_PENALTY
			}
		}
		
		#Conversion penalties for County Faith Tenets
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					has_doctrine = tenet_false_conversion_sanction
				}
			}
			add = {
				value = scope:councillor.conversion_false_conversion_sanction_resistance
				desc = COURT_CHAPLAIN_CONVERSION_FALSE_CONVERSION_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					has_doctrine = tenet_reincarnation
				}
			}
			add = {
				value = scope:councillor.conversion_reincarnation_resistance
				desc = COURT_CHAPLAIN_CONVERSION_REINCARNATION_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					has_doctrine = tenet_dharmic_pacifism
				}
			}
			add = {
				value = scope:councillor.conversion_dharmic_pacifism_resistance
				desc = COURT_CHAPLAIN_CONVERSION_DHARMIC_PACIFISM_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					has_doctrine_parameter = tenet_adaptive_conversion_resistance
				}
			}
			add = {
				value = scope:councillor.conversion_adaptive_resistance
				desc = COURT_CHAPLAIN_CONVERSION_ADAPTIVE_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					has_doctrine = tenet_pastoral_isolation
				}
			}
			add = {
				value = scope:councillor.conversion_pastoral_isolation_resistance
				desc = COURT_CHAPLAIN_CONVERSION_PASTORAL_ISOLATION_MODIFIER
			}
		}
		if = {
			limit = {
				scope:councillor.liege.faith = { has_doctrine = tenet_communal_identity }
				exists = scope:county
				NOT = { scope:county.culture = scope:councillor.liege.culture }
			}
			add = {
				value = scope:councillor.conversion_communal_identity_resistance
				desc = COURT_CHAPLAIN_CONVERSION_COMMUNAL_IDENTITY_PENALTY_MODIFIER
			}
		}

		#Conversion bonuses for Character Faith Tenets
		if = {
			limit = {
				scope:councillor.faith = {
					has_doctrine_parameter = mendicant_preachers_conversion_active
				}
			}
			add = {
				value = scope:councillor.conversion_mendicant_preachers_bonus
				desc = COURT_CHAPLAIN_CONVERSION_MENDICANT_PREACHERS_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = {
					has_doctrine_parameter = same_culture_conversion_bonus_active
				}
				scope:county.culture = scope:councillor.liege.culture
			}
			add = {
				value = scope:councillor.conversion_communal_identity_bonus
				desc = COURT_CHAPLAIN_CONVERSION_COMMUNAL_IDENTITY_BONUS_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = {
					has_doctrine_parameter = ghw_no_hof_conversion_buffs_active
					OR = {
						has_doctrine_parameter = no_head_of_faith
						NOT = { exists = religious_head }
					}
					holy_sites_controlled >= 1
				}
			}
			add = {
				value = scope:councillor.conversion_ghw_tenet_no_hof_bonus
				desc = COURT_CHAPLAIN_CONVERSION_GHW_TENET_NO_HOF_MODIFIER
			}
		}

		#Maluses for syncretic faiths.
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = { has_doctrine_parameter = unreformed_syncretic_actor_opinion_active }
				scope:county.faith = { has_doctrine = unreformed_faith_doctrine}
			}
			add = {
				value = scope:councillor.conversion_syncretic_with_religion_malus
				desc = COURT_CHAPLAIN_CONVERSION_SYNCRETIC_WITH_RELIGION_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = { has_doctrine_parameter = christian_syncretic_actor_opinion_active }
				scope:county.faith = { religion_tag = christianity_religion }
			}
			add = {
				value = scope:councillor.conversion_syncretic_with_religion_malus
				desc = COURT_CHAPLAIN_CONVERSION_SYNCRETIC_WITH_RELIGION_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = { has_doctrine_parameter = islamic_syncretic_actor_opinion_active }
				scope:county.faith = { religion_tag = islam_religion }
			}
			add = {
				value = scope:councillor.conversion_syncretic_with_religion_malus
				desc = COURT_CHAPLAIN_CONVERSION_SYNCRETIC_WITH_RELIGION_MODIFIER
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = { has_doctrine_parameter = jewish_syncretic_actor_opinion_active }
				scope:county.faith = { religion_tag = judaism_religion }
			}
			add = {
				value = scope:councillor.conversion_syncretic_with_religion_malus
				desc = COURT_CHAPLAIN_CONVERSION_SYNCRETIC_WITH_RELIGION_MODIFIER
			}
		}

		#Various Modifier Penalties
		if = {
			limit = {
				exists = scope:county
				scope:county = { has_county_modifier = governance_1074_local_faith_respected_modifier }
			}
			add = {
				value = scope:councillor.local_faith_respected_modifier_value
				desc = COURT_CHAPLAIN_CONVERSION_LOCAL_COUNTY_MODIFIERS
			}
		}

		#Various Modifier Bonuses
		if = {
			limit = {
				exists = scope:county
				scope:county = { has_county_modifier = governance_1074_population_fled_persecution_modifier }
			}
			add = {
				value = scope:councillor.population_fled_persecution_modifier_value
				desc = COURT_CHAPLAIN_CONVERSION_LOCAL_COUNTY_MODIFIERS
			}
		}
		

		#Conversion bonuses from certain Holy Sites.
		if = {
			limit = {
				scope:councillor.faith = {
					controls_holy_site = jerusalem
				}
				title:b_jerusalem = {
					is_holy_site_of = scope:councillor.faith
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_jerusalem
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_JERUSALEM
			}
		}
		if = {
			limit = {
				scope:councillor.faith = {
					controls_holy_site = kerala
				}
				title:b_honnore = {
					is_holy_site_of = scope:councillor.faith
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_kerala
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_KERALA
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:councillor.faith = {
					controls_holy_site = iona
				}
				title:b_islay = {
					is_holy_site_of = scope:councillor.faith
				}
				scope:county.title_province = {
					geographical_region = world_europe_west_britannia
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_iona
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_IONA
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					controls_holy_site = wadi_el_milk
				}
				title:b_wadi_el-milk = {
					is_holy_site_of = scope:councillor.faith
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_wadi_el_milk
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_WADI_EL_MILK
			}
		}
		if = {
			limit = {
				scope:councillor.faith = {
					controls_holy_site = cordoba
				}
				title:b_cordoba = {
					is_holy_site_of = scope:councillor.faith
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_cordoba
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_CORDOBA
			}
		}

		#Maluses from certain Holy Sites.
		if = {
			limit = {
				exists = scope:county
				scope:county.faith = {
					controls_holy_site = visoki
				}
				title:b_visoki = {
					is_holy_site_of = scope:county.faith
				}
			}
			add = {
				value = scope:councillor.conversion_holy_site_visoki
				desc = COURT_CHAPLAIN_CONVERSION_HOLY_SITE_VISOKI
			}
		}

		#Other
		if = {
			limit = {
				scope:councillor.liege = {
					has_trait = savior
				}
			}
			add = {
				value = scope:councillor.conversion_savior_liege
				desc = COURT_CHAPLAIN_CONVERSION_LIEGE_IS_SAVIOR
			}
		}
		if = {
			limit = {
				scope:councillor.liege = {
					has_trait = divine_blood
				}
			}
			add = {
				value = scope:councillor.conversion_divine_blood_liege
				desc = COURT_CHAPLAIN_CONVERSION_LIEGE_IS_DIVINE_BLOOD
			}
		}
		if = {
			limit = {
				exists = scope:county
				scope:county = {
					has_variable = learning_encouraged_conversion
				}
			}
			add = {
				value = scope:councillor.conversion_learning_theology
				desc = COURT_CHAPLAIN_CONVERSION_LEARNING_THEOLOGY
			}
		}
		
		# Development reduces the speed.
		if = {
			limit = {
				exists = scope:county
				scope:county = {
					development_level > 0
				}
			}
			add = {
				value = scope:county.convert_faith_development_penalty
				desc = STEWARD_PROMOTE_CULTURE_DEVELOPMENT_PENALTY
			}
		}
		
		if = {
			limit = {
				scope:councillor.faith = {
					has_doctrine_parameter = unreformed
				}
			}
			multiply = {
				value = conversion_unreformed_faith_penalty
				desc = COURT_CHAPLAIN_CONVERSION_UNREFORMED_FAITH_PENALTY
			}
		}
		
		# Conversion speed game rules
		if = {
			limit = {
				has_game_rule = slower_faith_conversion_speed
			}
			multiply = {
				value = slower_game_rule_value
				desc = GAME_RULE_SLOWER_REASON
			}
		}
		if = {
			limit = {
				has_game_rule = significantly_slower_faith_conversion_speed
			}
			multiply = {
				value = significantly_slower_game_rule_value
				desc = GAME_RULE_SIGNIFICANTLY_SLOWER_REASON
			}
		}
		if = {
			limit = {
				has_game_rule = faster_faith_conversion_speed
			}
			multiply = {
				value = faster_game_rule_value
				desc = GAME_RULE_FASTER_REASON
			}
		}
		if = {
			limit = {
				has_game_rule = significantly_faster_faith_conversion_speed
			}
			multiply = {
				value = significantly_faster_game_rule_value
				desc = GAME_RULE_SIGNIFICANTLY_FASTER_REASON
			}
		}
	}

	potential_county = {
		scope:county = {
			NOT = { faith = scope:councillor.faith }
			custom_description = {
				text = "is_protected_via_contract_self_or_liege"
				subject = holder
				NAND = { # Vassal Contract forbids meddling by liege
					exists = holder.liege
					holder = {
						OR = {
							AND = {
								liege = scope:councillor_liege
								is_ruler = yes
								has_government = feudal_government 
								is_independent_ruler = no
								vassal_contract_has_flag = religiously_protected
							}
							any_liege_or_above = {
								exists = liege
								liege = scope:councillor_liege
								is_ruler = yes
								has_government = feudal_government 
								is_independent_ruler = no
								vassal_contract_has_flag = religiously_protected
							}
						}
					}
				}
			}
		}
	}

	on_finish_task_county = {
		scope:county = {
			set_county_faith = scope:councillor.faith
		}
		if = {
			limit = {
				scope:councillor = {
					has_council_position = councillor_court_chaplain
				}
			}
			scope:councillor = {
				start_default_task = yes
			}
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_court_chaplain_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly_county = {
		scope:councillor_liege = {
			if = {
				limit = {
					has_character_flag = no_court_chaplain_side_effects_first_month
				}
				remove_character_flag = no_court_chaplain_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = task_convert_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1000 # Always convert if possible

		if = {	#Unless you're a crypto-religionist.
			limit = {
				scope:councillor_liege = { has_variable = false_convert }
			}
			add = -1000
		}
	}
}
synkellos_task_intellectual_activity = {
	position = roman_councillor_synkellos
	# default_task = yes
	
	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = synkellos_task_intellectual_activity_desc

	council_owner_modifier = {
		name = court_chaplain_learning_modifier
		monthly_learning_lifestyle_xp_gain_mult = 0.2
		scale = court_chaplain_religious_relations_modifier
	}

	council_owner_modifier = {
		name = court_chaplain_innovation_modifier
		cultural_head_fascination_add = 0.1
		scale = court_chaplain_religious_relations_modifier
	}

	ai_will_do = {
		value = 1 # Always a good backup

	}
}

sakellarios_task_collect_taxes = {
	default_task = yes
	position = roman_councillor_sakellarios

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_collect_taxes_effect_desc
		triggered_desc = {
			trigger = { liege = { has_perk = tax_man_perk } }
			desc = task_collect_taxes_tax_man_bonus_desc
		}
		triggered_desc = {
			trigger = {
				exists = liege.dynasty
				liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
				}
			desc = task_collect_taxes_erudition_bonus_desc
		}
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					stewardship > mediocre_skill_rating
				}
				desc = task_collect_taxes_extra_taxes
			}
			triggered_desc = {
				trigger = {
					stewardship < high_skill_rating
					any_sub_realm_county = {
						steward_task_county_corruption_county_trigger = yes
					}
				}
				desc = task_collect_taxes_county_corruption
			}
		}
	}

	council_owner_modifier = {
		name = task_collect_taxes_modifier
		domain_tax_mult = 1
		scale = steward_collect_taxes_total_scale
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_steward_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly = {
		liege = {
			if = {
				limit = {
					has_character_flag = no_steward_side_effects_first_month
				}
				remove_character_flag = no_steward_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = task_collect_taxes_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup
		if = {
			limit = {
				scope:councillor_liege.gold < 100
			}
			add = 100
		}
	}
}
sakellarios_task_manage_treasury = {
	position = roman_councillor_sakellarios

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_collect_taxes_effect_desc
	}

	council_owner_modifier = {
		name = task_collect_manage_treasury
		build_gold_cost = -0.2
		scale = steward_collect_taxes_total_scale
	}

	ai_will_do = {
		value = 1 # Always a good backup
	}
}
sakellarios_task_develop_county = {
	position = roman_councillor_sakellarios

	task_type = task_type_county
	county_target = realm
	ai_county_target = domain
	task_progress = task_progress_value
	task_current_value = scope:councillor_liege.steward_develop_county_current_progress
	task_max_value = 100
	highlight_own_realm = yes

	effect_desc = {
		desc = task_develop_county_complete_effect_desc
		desc = task_develop_county_effect_desc
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					stewardship > mediocre_skill_rating
					trigger_if = {
						limit = {
							exists = scope:county
						}
						scope:county = {
							NOT = { has_county_modifier = steward_task_efficient_taxation_modifier }
						}
					}
				}
				desc = task_develop_county_efficient_taxation
			}
			triggered_desc = {
				trigger = {
					stewardship > mediocre_skill_rating
					trigger_if = {
						limit = { exists = scope:county }
						scope:county = {
							county_control < full_county_control
						}
					}
				}
				desc = task_develop_county_increased_control
			}
			triggered_desc = {
				trigger = {
					stewardship < high_skill_rating
					trigger_if = {
						limit = { exists = scope:county }
						scope:county = {
							NOT = { has_county_modifier = steward_settler_resistance_modifier }
						}
					}
				}
				desc = task_develop_county_increased_control
			}
			triggered_desc = {
				trigger = {
					stewardship < high_skill_rating
					trigger_if = {
						limit = { exists = scope:county }
						scope:county = {
							NOT = { has_county_modifier = steward_construction_slowdown_modifier }
						}
					}
				}
				desc = task_develop_county_slow_construction
			}
			triggered_desc = {
				trigger = {
					stewardship < high_skill_rating
					trigger_if = {
						limit = { exists = scope:county }
						scope:county = {
							NOT = { has_county_modifier = steward_population_mismanaged_modifier }
						}
					}
				}
				desc = task_develop_county_loss_of_opinion
			}
			triggered_desc = {
				trigger = {
					stewardship < high_skill_rating
					trigger_if = {
						limit = { exists = scope:county }
						scope:county = {
							county_control > low_county_control
						}
					}
				}
				desc = task_develop_county_loss_of_control
			}
		}
	}

	# TOTAL PROGRESS MUST MATCH THE TOTAL OF THE COUNTY MODIFIERS BELOW
		# Add all new progress values to the script value steward_develop_county_total
		# Note that for Develop County, the County Modifiers apply the actual values, while progress is for player info only
	progress = {
		value = 0
		add = {
			value = steward_develop_county_base
			desc = STEWARD_PROGRESS_BASE
		}
		add = {
			value = scope:councillor.steward_develop_county_monthly_increase
			desc = SCALED_COUNCILLOR_STEWARDSHIP_VALUE
		}
		if = {
			limit = {
				scope:councillor_liege = { has_perk = planned_cultivation_perk }
			}
			add = {
				value = scope:councillor.steward_develop_county_perk_bonus_monthly_increase
				desc = DEVELOP_COUNTY_PERK_BONUS_VALUE
			}
		}
		if = {
			limit = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			add = {
				value = scope:councillor.steward_develop_county_erudition_bonus_monthly_increase
				desc = ERUDITION_DYNASTY_PERK_BONUS_VALUE
			}
		}

		# Relation Bonuses/Penalties
		if = { # Friend
			limit = {
				scope:councillor_liege = {
					has_relation_friend = scope:councillor
					NOT = { has_relation_best_friend = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.steward_develop_county_monthly_increase_friend_bonus
				desc = COUNCILLOR_IS_YOUR_FRIEND
			}
		}
		if = { # Best Friend
			limit = {
				scope:councillor_liege = {
					has_relation_best_friend = scope:councillor
				}
			}
			add = {
				value = scope:councillor.steward_develop_county_monthly_increase_best_friend_bonus
				desc = COUNCILLOR_IS_YOUR_BEST_FRIEND
			}
		}
		if = { # Rival
			limit = {
				scope:councillor_liege = {
					has_relation_rival = scope:councillor
					NOT = { has_relation_nemesis = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.steward_develop_county_monthly_increase_rival_bonus
				desc = COUNCILLOR_IS_YOUR_RIVAL
			}
		}
		if = { # Nemesis
			limit = {
				scope:councillor_liege = {
					has_relation_nemesis = scope:councillor
				}
			}
			add = {
				value = scope:councillor.steward_develop_county_monthly_increase_nemesis_bonus
				desc = COUNCILLOR_IS_YOUR_NEMESIS
			}
		}
		if = { #Tribal penalty
			limit = {
				scope:councillor_liege = {
					should_apply_tribal_development_penalty_trigger = yes	
				}
			}
			add = {
				value = scope:councillor.steward_develop_county_tribal_penalty
				desc = DEVELOP_COUNTY_TRIBAL_PENALTY_VALUE
			}
		}	
		if = { # Development reduces the speed.
			limit = {
				exists = scope:county
				scope:county = {
					development_level > 0
				}
			}
			add = {
				value = scope:county.current_development_penalty
				desc = STEWARD_CURRENT_DEVELOPMENT_PENALTY
			}
		}
		
		if = {
			limit = { exists = scope:county }
			multiply = {
				value = scope:county.development_rate_modifier
				desc = STEWARD_COUNTY_SPEED_MODIFIERS
			}
		}
	}
	full_progress = steward_develop_county_full_progress
	custom_other_loc = STEWARD_COUNTY_SPEED_OTHER

	potential_county = {
		scope:county = {
			development_level < max_development_level
			trigger_if = {
				limit = {
					scope:councillor_liege = { is_ai = yes }
				}
				OR = {
					this = scope:councillor_liege.capital_county
					title_province = {
						OR = {
							terrain = oasis
							terrain = farmlands
							terrain = floodplains
						}
					}
				}
			}
		}
	}

	county_modifier = {
		name = steward_develop_county_modifier
		development_growth = 100
		holding_build_speed = -7
		#holding_build_gold_cost = -1
		build_speed = -7
		#build_gold_cost = -1
		scale = { value = steward_develop_county_total divide = 100 }
	}

	county_modifier = {
		name = steward_develop_county_current_development_modifier
		development_growth = 100
		scale = { value = scope:councillor.current_development_penalty divide = 100 }
	}

	county_modifier = {
		name = steward_develop_county_tribal_penalty_modifier
		development_growth = 100
		scale = {
			value = 0
			if = {
				limit = {
					scope:councillor_liege = {
						should_apply_tribal_development_penalty_trigger = yes
					}
				}
				value = scope:councillor.steward_develop_county_tribal_penalty
				divide = 100
			}
		}
	}

	on_finish_task_county = {
		if = {
			limit = {
				OR = {
					AND = {
						exists = scope:county
						scope:county = {
							development_level = max_development_level
						}
					}
					scope:councillor_liege = {
						is_ai = yes
					}
				}
			}
			start_default_task = yes
		}
		scope:councillor_liege = {
			add_character_flag = {
				flag = no_ai_increase_development
				years = 10
			}
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_steward_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly_county = {
		scope:councillor_liege = {
			if = {
				limit = {
					has_character_flag = no_steward_side_effects_first_month
				}
				remove_character_flag = no_steward_side_effects_first_month
				add_character_flag = {
					flag = ai_development_max_years
					years = 10
				}
			}
			else = {
				trigger_event = {
					on_action = task_develop_county_side_effects
					days = { 1 30 }
				}
			}
			
			if = {
				limit = {
					NOT = {
						has_character_flag = ai_development_max_years
					}
				}
				add_character_flag = {
					flag = no_ai_increase_development
					years = 10
				}
			}
		}
	}

	ai_will_do = {
		value = 0
		if = {
			# Don't do this too often
			limit = {
				scope:councillor_liege = { has_character_flag = no_ai_increase_development }
			}
		}
		else_if = {
			limit = {
				scope:councillor_liege.gold >= steward_increase_development_value
			}
			add = 100
		}
	}
}

logothetes_task_foreign_affairs = {
	default_task = yes
	position = roman_councillor_drome
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		### Prestige tooltip
		desc = task_foreign_affairs_prestige_effect_desc
		# Adaptive Traditions tooltip
		triggered_desc = {
			trigger = { liege = { has_perk = adaptive_traditions_perk } }
			desc = task_foreign_affairs_effect_desc_adaptive_traditions_bonus_prestige
		}
		# Bureaucrats tooltip
		triggered_desc = {
			trigger = {
				exists = liege.dynasty
				liege.dynasty = { has_dynasty_perk = erudition_legacy_5 } }
			desc = task_foreign_affairs_effect_desc_bureaucrats_bonus_prestige
		}
		# Opinion tooltip
		first_valid = {
			triggered_desc = {
				trigger = { liege = { is_independent_ruler = no } }
				desc = {
					desc = task_foreign_affairs_fallback_effect_desc
					desc = task_foreign_affairs_not_independent_effect_desc
				}
			}
			desc = task_foreign_affairs_independent_effect_desc
		}
		# Adaptive Traditions tooltip
		triggered_desc = {
			trigger = { liege = { has_perk = adaptive_traditions_perk } }
			desc = task_foreign_affairs_effect_desc_adaptive_traditions_bonus_opinion
		}
		# Bureaucrats tooltip
		triggered_desc = {
			trigger = {
				exists = liege.dynasty
				liege.dynasty = { has_dynasty_perk = erudition_legacy_5 } }
			desc = task_foreign_affairs_effect_desc_bureaucrats_bonus_opinion
		}

		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_foreign_affairs_shorten_truce
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_foreign_affairs_enemy_claim
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_foreign_shorten_enemy_truce
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_foreign_neighbor_opinion_loss
			}
		}
	}

	on_start_task = {
		set_variable = {
			name = chancellor_foreign_affairs_opinion_value
			value = 0
		}
		liege = {
			add_character_flag = {
				flag = no_chancellor_side_effects_first_month
				days = 30
			}
		}
	}

	on_cancel_task = {
		remove_variable = chancellor_foreign_affairs_opinion_value
	}

	council_owner_modifier = {
		name = task_foreign_affairs_prestige_modifier
		monthly_prestige = 1
		scale = chancellor_foreign_affairs_prestige_gain_base
	}

	council_owner_modifier = {
		name = task_foreign_affairs_prestige_perk_bonus_modifier
		monthly_prestige = 1
		scale = chancellor_foreign_affairs_prestige_gain_perk_bonus_scale
	}

	council_owner_modifier = {
		name = task_foreign_affairs_prestige_dynasty_perk_bonus_modifier
		monthly_prestige = 1
		scale = chancellor_foreign_affairs_prestige_gain_erudition_modifier
	}

	council_owner_modifier = {
		name = task_foreign_affairs_opinion_modifier
		independent_ruler_opinion = 1
		scale = chancellor_foreign_affairs_independent_opinion_scale
	}

	council_owner_modifier = {
		name = task_foreign_affairs_opinion_modifier
		fellow_vassal_opinion = 1
		scale = chancellor_foreign_affairs_realm_opinion_scale
	}

	on_monthly = {
		if = {
			limit = {
				liege = { is_ai = no }
			}
			if = {
				limit = {
					liege = { has_variable = chancellor_foreign_affairs_opinion_value }
				}
				if = {
					limit = {
						liege.var:chancellor_foreign_affairs_opinion_value < chancellor_foreign_affairs_opinion_max
					}
					liege = {
						change_variable = {
							name = chancellor_foreign_affairs_opinion_value
							add = root.chancellor_foreign_affairs_monthly_increase
						}
					}
				}
				if = {
					limit = {
						liege.var:chancellor_foreign_affairs_opinion_value > chancellor_foreign_affairs_opinion_max
					}
					liege = {
						set_variable = {
							name = chancellor_foreign_affairs_opinion_value
							value = root.chancellor_foreign_affairs_opinion_max
						}
					}
				}
			}
			else = {
				liege = {
					set_variable = {
						name = chancellor_foreign_affairs_opinion_value
						value = root.chancellor_foreign_affairs_monthly_increase
					}
				}
			}
		}
		liege = {
			if = {
				limit = {
					has_character_flag = no_chancellor_side_effects_first_month
				}
				remove_character_flag = no_chancellor_side_effects_first_month
			}
			else = {
				#Side effects
				trigger_event = {
					on_action = task_foreign_affairs_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup
	}
}
logothetes_task_domestic_affairs = {
	position = roman_councillor_drome
	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_domestic_affairs_effect_desc
		triggered_desc = {
			trigger = {
				liege = { has_perk = chains_of_loyalty_perk }
			}
			desc = task_domestic_affairs_chains_of_loyalty_bonus_desc
		}
		triggered_desc = {
			trigger = {
				exists = liege.dynasty
				liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }	
			}
			desc = task_domestic_affairs_bureaucrats_bonus_desc
		}
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_increase_control_improved_vassal_opinion
			}
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
					liege = {
						any_vassal = {
							has_government = feudal_government
							primary_title.tier > tier_barony
						}
					}
				}
				desc = task_increase_control_improve_vassal_contract
			}
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_increase_control_end_internal_war
			}
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_increase_control_force_vassal_partition
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_increase_control_lose_vassal_opinion
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
					liege = {
						any_vassal = {
							has_government = feudal_government
							primary_title.tier > tier_barony
						}
					}
				}
				desc = task_increase_control_worsen_contract
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_increase_control_loss_of_crown_authority
			}
		}
	}

	on_start_task = {
		set_variable = {
			name = chancellor_domestic_affairs_opinion_value
			value = 0
		}

		liege = {
			add_character_flag = {
				flag = no_chancellor_side_effects_first_month
				days = 30
			}
		}
	}

	on_cancel_task = {
		if = {
			limit = {
				is_alive = yes
				has_variable = chancellor_domestic_affairs_opinion_value
			}
			remove_variable = chancellor_domestic_affairs_opinion_value
		}
	}

	council_owner_modifier = {
		name = task_domestic_affairs_opinion_moidifier
		direct_vassal_opinion = 1
		scale = chancellor_domestic_affairs_opinion_scale
	}

	on_monthly = {
		if = {
			limit = {
				liege = { is_ai = no }
			}
			if = {
				limit = {
					liege = { 
						has_variable = chancellor_domestic_affairs_opinion_value 
					}
				}
				liege = {
					if = {
						limit = {
							var:chancellor_domestic_affairs_opinion_value < root.chancellor_domestic_affairs_opinion_max
						}
						change_variable = {
							name = chancellor_domestic_affairs_opinion_value
							add = root.chancellor_domestic_affairs_monthly_increase
						}
					}
					if = {
						limit = {
							var:chancellor_domestic_affairs_opinion_value > root.chancellor_domestic_affairs_opinion_max
						}
						set_variable = {
							name = chancellor_domestic_affairs_opinion_value
							value = root.chancellor_domestic_affairs_opinion_max
						}
					}
				}	
			}
			else = {
				liege = {
					set_variable = {
						name = chancellor_domestic_affairs_opinion_value
						value = 0
					}
				}
			}
		}
		liege = {
			if = {
				limit = {
					has_character_flag = no_chancellor_side_effects_first_month
				}
				remove_character_flag = no_chancellor_side_effects_first_month
			}
			else = {
				#Side effects
				trigger_event = {
					on_action = task_domestic_affairs_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 0
		if = { # Do this if you have a faction against you, every little bit helps
			limit = {
				scope:councillor_liege = {
					any_targeting_faction = {
						OR = {
							faction_is_type = independence_faction
							faction_is_type = liberty_faction
							faction_is_type = claimant_faction
						}
					}
				}
			}
			add = 1000
		}
	}
}
logothetes_task_integrate_title = {
	position = roman_councillor_drome
	task_type = task_type_county
	county_target = realm
	task_progress = task_progress_value
	task_current_value = scope:councillor_liege.chancellor_integrate_title_current_progress

	task_max_value = define:NTitle|DRIFT_PROGRESS_LIMIT

	effect_desc = {
		desc = task_integrate_title_effect_desc
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_integrate_title_nobles_support_integration
			}
			triggered_desc = {
				trigger = {
					diplomacy > mediocre_skill_rating
				}
				desc = task_integrate_title_culture_supports_integration
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_integrate_title_nobles_resist_integration
			}
			triggered_desc = {
				trigger = {
					diplomacy < high_skill_rating
				}
				desc = task_integrate_title_culture_resists_integration
			}
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_chancellor_side_effects_first_month
				days = 30
			}
		}
	}

	is_valid_showing_failures_only =  {
		liege = {
			custom_description = {
				text = "is_king_or_emperor"
				highest_held_title_tier >= tier_kingdom
			}
		}
	}

	on_finish_task_county = {
		start_default_task = yes
	}

	potential_county = {
		scope:county = {
			de_jure_drifting_towards = scope:councillor_liege.primary_title
		}
	}

	progress = {
		value = 0
		add = {
			value = define:NTitle|DRIFT_MONTHLY_PROGRESS_INCREASE
			desc = PASSIVE_INTEGRATION_PROGRESS_VALUE
		}
		add = {
			value = scope:councillor.chancellor_integrate_title_progress_gain
			desc = SCALED_COUNCILLOR_DIPLOMACY_VALUE
		}
		# Relation Bonuses/Penalties
		if = { # Friend
			limit = {
				scope:councillor_liege = {
					has_relation_friend = scope:councillor
					NOT = { has_relation_best_friend = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.chancellor_integrate_title_monthly_increase_friend_bonus
				desc = COUNCILLOR_IS_YOUR_FRIEND
			}
		}
		if = { # Best Friend
			limit = {
				scope:councillor_liege = {
					has_relation_best_friend = scope:councillor
				}
			}
			add = {
				value = scope:councillor.chancellor_integrate_title_monthly_increase_best_friend_bonus
				desc = COUNCILLOR_IS_YOUR_BEST_FRIEND
			}
		}
		if = { # Rival
			limit = {
				scope:councillor_liege = {
					has_relation_rival = scope:councillor
					NOT = { has_relation_nemesis = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.chancellor_integrate_title_monthly_increase_rival_bonus
				desc = COUNCILLOR_IS_YOUR_RIVAL
			}
		}
		if = { # Nemesis
			limit = {
				scope:councillor_liege = {
					has_relation_nemesis = scope:councillor
				}
			}
			add = {
				value = scope:councillor.chancellor_integrate_title_monthly_increase_nemesis_bonus
				desc = COUNCILLOR_IS_YOUR_NEMESIS
			}
		}
		if = {
			limit = {
				exists = scope:councillor.liege.dynasty
				scope:councillor.liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			add = {
				value = scope:councillor.chancellor_integrate_title_erudition_bonus
				desc = INTEGRATE_TITLE_DYNASTY_PERK_BONUS_VALUE
			}
		}
	}

	on_monthly_county = {
		if = {
			# Due to code setup, it might not have invalidated yet if this is not the case
			limit = {
				scope:county = {
					de_jure_drifting_towards = scope:councillor_liege.primary_title
				}
			}
			scope:county = {
				change_de_jure_drift_progress = {
					target = scope:councillor_liege.primary_title
					value = scope:councillor.chancellor_integrate_title_progress_gain
				}
			}
		}

		scope:councillor_liege = {
			if = {
				limit = {
					has_character_flag = no_chancellor_side_effects_first_month
				}
			}
			else = {
				#Side effects
				trigger_event = {
					on_action = task_integrate_title_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 10 # Prefer this if available
	}
}

domestikos_task_organize_levies = {
	default_task = yes
	position = roman_councillor_domestikos

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_organize_levies_effect_desc
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_organize_levies_erudition_bonus
		}
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					any_sub_realm_county = {
						marshal_task_1101_county_trigger = yes
					}
					martial > mediocre_skill_rating
				}
				desc = task_organize_levies_well_organized_service
			}
			triggered_desc = {
				trigger = {
					any_sub_realm_county = {
						marshal_task_1102_county_trigger = yes
					}
					martial > mediocre_skill_rating
				}
				desc = task_organize_levies_increased_military_presence
			}
			triggered_desc = {
				trigger = {
					NOT = {
						has_character_modifier = marshal_task_levy_desertions_modifier
					}
					martial < high_skill_rating
				}
				desc = task_organize_levies_levy_desertion
			}
			triggered_desc = {
				trigger = {
					any_sub_realm_county = {
						marshal_task_1002_county_trigger = yes
					}
					martial < high_skill_rating
				}
				desc = task_organize_levies_unused_farmland
			}
			triggered_desc = {
				trigger = {
					any_sub_realm_county = {
						marshal_task_1003_county_trigger = yes
					}
					martial < high_skill_rating
				}
				desc = task_organize_levies_insufficient_guards
			}
		}
	}
	
	council_owner_modifier = {
		name = task_organize_levies_modifier
		levy_size = 1
		garrison_size = 1
		levy_reinforcement_rate = 1
		scale = {
			value = marshal_organize_levies_modifier_value
			divide = 100
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_marshal_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly = {
		liege = {
			if = {
				limit = {
					has_character_flag = no_marshal_side_effects_first_month
				}
				remove_character_flag = no_marshal_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = organize_the_levies_marshal_task_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup
	}
}
domestikos_task_train_commanders = {
	position = roman_councillor_domestikos

	task_type = task_type_general
	task_progress = task_progress_infinite
	
	effect_desc = {
		### MaA Maintenance
		desc = task_train_commanders_maa_effect_desc
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_train_commanders_maa_erudition_bonus_desc
		}

		### Commander Improvement
		desc = task_train_commanders_effect_desc
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_train_commanders_commander_erudition_bonus_desc
		}

		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					martial > mediocre_skill_rating
				}
				desc = task_train_commanders_commander_learns_from_commander
			}
			triggered_desc = {
				trigger = {
					martial > mediocre_skill_rating
				}
				desc = task_train_commanders_knight_improved
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_train_commanders_commander_wounded
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_train_commanders_commander_maimed
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_train_commanders_commander_killed
			}
		}
	}
	
	council_owner_modifier = {
		name = task_train_commanders_modifier
		men_at_arms_maintenance = -1
		scale = marshal_train_commanders_maa_total
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_marshal_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly = {
		liege = {
			random = {
				chance = scope:councillor.marshal_train_commanders_monthly_chance_value
				trigger_event = {
					on_action = train_commanders_success_effect
				}
			}
			if = {
				limit = {
					has_character_flag = no_marshal_side_effects_first_month
				}
				remove_character_flag = no_marshal_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = train_commanders_marshal_task_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 0
		if = { # Try to save up a war chest before starting to Organize Levies
			limit = {
				scope:councillor_liege = {
					number_of_maa_regiments >= 1
					OR = {
						scope:councillor_liege.gold < scope:councillor_liege.ai_war_chest_desired_gold_value
						is_at_war = yes
					}
				}
			}
			add = 100
		}
		if = { # Try to avoid Bankruptcy during war
			limit = {
				scope:councillor_liege = {
					number_of_maa_regiments >= 1
					is_at_war = yes
					monthly_character_income < monthly_character_expenses
				}
			}
			add = 2000
		}
	}
}
domestikos_task_increase_control = {
	position = roman_councillor_domestikos

	task_type = task_type_county
	county_target = realm
	ai_county_target = domain
	task_progress = task_progress_value
	task_current_value = scope:councillor_liege.marshal_increase_control_current_progress
	task_max_value = 100 # Highest possible county control
	highlight_own_realm = yes
	restart_on_finish = yes # If it "finishes" by removing a corruption modifier, there'll still be control to regain

	effect_desc = {
		desc = task_increase_control_effect_desc
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					martial > mediocre_skill_rating
				}
				desc = task_increase_control_increase_opinion
			}
			triggered_desc = {
				trigger = {
					martial > mediocre_skill_rating
				}
				desc = task_increase_control_baron_opinion_increase
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_increase_control_lose_opinion
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_increase_control_lose_control
			}
			triggered_desc = {
				trigger = {
					martial < high_skill_rating
				}
				desc = task_increase_control_baron_opinion_loss
			}
		}
	}
	
	# TOTAL PROGRESS MUST MATCH THE TOTAL OF THE COUNTY MODIFIERS BELOW
		# Add all new progress values to the script value marshal_increase_control_total
		# Note that for Increase Control, the County Modifiers apply the actual values, while progress is for player info only
	progress = {
		value = 0
		add = {
			value = marshal_increase_control_base
			desc = INCREASE_CONTROL_BASE
		}
		add = {
			value = scope:councillor.marshal_increase_county_control_monthly_change
			desc = SCALED_COUNCILLOR_MARTIAL_VALUE
		}
		# Relation Bonuses/Penalties
		if = { # Friend
			limit = {
				scope:councillor_liege = {
					has_relation_friend = scope:councillor
					NOT = { has_relation_best_friend = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.marshal_increase_control_monthly_increase_friend_bonus
				desc = COUNCILLOR_IS_YOUR_FRIEND
			}
		}
		if = { # Best Friend
			limit = {
				scope:councillor_liege = {
					has_relation_best_friend = scope:councillor
				}
			}
			add = {
				value = scope:councillor.marshal_increase_control_monthly_increase_best_friend_bonus
				desc = COUNCILLOR_IS_YOUR_BEST_FRIEND
			}
		}
		if = { # Rival
			limit = {
				scope:councillor_liege = {
					has_relation_rival = scope:councillor
					NOT = { has_relation_nemesis = scope:councillor }
				}
			}
			add = {
				value = scope:councillor.marshal_increase_control_monthly_increase_rival_bonus
				desc = COUNCILLOR_IS_YOUR_RIVAL
			}
		}
		if = { # Nemesis
			limit = {
				scope:councillor_liege = {
					has_relation_nemesis = scope:councillor
				}
			}
			add = {
				value = scope:councillor.marshal_increase_control_monthly_increase_nemesis_bonus
				desc = COUNCILLOR_IS_YOUR_NEMESIS
			}
		}
		if = {
			limit = {
				scope:councillor_liege = { has_perk = strict_organization_perk }
			}
			add = {
				value = scope:councillor.marshal_increase_county_control_perk_bonus_monthly_change
				desc = INCREASE_CONTROL_PERK_BONUS_VALUE
			}
		}
		if = {
			limit = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			add = {
				value = scope:councillor.marshal_increase_county_control_erudition_bonus_monthly_change
				desc = ERUDITION_DYNASTY_PERK_BONUS_VALUE
			}
		}
		if = {
			limit = { exists = scope:county }
			multiply = {
				value = scope:county.county_control_rate_modifier
				desc = MARSHAL_COUNTY_SPEED_MODIFIERS
			}
		}
	}

	full_progress = marshal_increase_control_full_progress
	custom_other_loc = MARSHAL_COUNTY_SPEED_OTHER

	potential_county = {
		scope:county = {
			custom_description = {
				text = potential_county_control_task_trigger
				OR = {
					has_county_corruption_trigger = yes
					county_control < full_county_control
				}
			}
			county_control_rate_modifier > 0
		}
	}

	county_modifier = {
		name = marshal_increase_control_modifier
		monthly_county_control_change_add = 1
		scale = marshal_increase_control_total
	}

	on_finish_task_county = {
		if = {
			limit = {
				scope:county = {
					has_county_corruption_trigger = yes
				}
			}
			scope:county = {
				marshal_remove_random_county_corruption_modifier_effect = yes
				change_county_control = -25
			}
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_marshal_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly_county = {
		random = {
			chance = scope:councillor.marshal_remove_county_corruption_chance
			scope:county = {
				marshal_remove_random_county_corruption_modifier_effect = yes
			}
		}
		if = {
			limit = {
				has_character_flag = no_marshal_side_effects_first_month
			}
			remove_character_flag = no_marshal_side_effects_first_month
		}
		else = {
			#Side effects
			scope:councillor_liege = {
				trigger_event = {
					on_action = task_increase_control_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1000 # Highest prio
		if = { # Keep doing Train Commanders if you're at war
			limit = {
				is_performing_council_task = task_train_commanders
				scope:councillor_liege = {
					is_at_war = yes
				}
			}
			add = -1000
		}
		if = { # Stop doing this if Train Commanders could help you lose less gold during a war
			limit = {
				NOT = {
					is_performing_council_task = task_train_commanders
				}
				scope:councillor_liege = {
					number_of_maa_regiments >= 1
					is_at_war = yes
					monthly_character_income < monthly_character_expenses
				}
			}
			add = -1000
		}
	}
}

kanikleios_task_disrupt_schemes = {
	position = roman_councillor_kanikleios
	default_task = yes

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_disrupt_schemes_hostile_scheme_resistance_base
		triggered_desc = {
			trigger = { scope:councillor_liege = { has_perk = court_of_shadows_perk } }
			desc = task_disrupt_schemes_hostile_scheme_resistance_perk_bonus
		}
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_disrupt_schemes_hostile_scheme_resistance_legacy_bonus
		}
		desc = task_disrupt_schemes_discovery_chance_base
		triggered_desc = {
			trigger = { scope:councillor_liege = { has_perk = court_of_shadows_perk } }
			desc = task_disrupt_schemes_discovery_chance_perk_bonus
		}
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_disrupt_schemes_discovery_chance_legacy_bonus
		}
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					intrigue > mediocre_skill_rating
				}
				desc = task_disrupt_schemes_hostile_scheme_disrupted
			}
			triggered_desc = {
				trigger = {
					intrigue < high_skill_rating
					scope:councillor_liege = {
						has_any_secrets = yes
					}
				}
				desc = task_disrupt_schemes_secret_revealed
			}
			triggered_desc = {
				trigger = {
					intrigue < high_skill_rating
				}
				desc = task_disrupt_schemes_courtier_secret_revealed
			}
		}
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_modifier
		hostile_scheme_resistance_add = 1.0
		scale = scope:councillor.spymaster_disrupt_schemes_modifier_base_scale
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_court_of_shadows_modifier
		hostile_scheme_resistance_add = 1.0
		scale = scope:councillor.spymaster_disrupt_schemes_court_of_shadows_modifier_scale
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_erudition_legacy_5_modifier
		hostile_scheme_resistance_add = 1.0
		scale = scope:councillor.spymaster_disrupt_schemes_erudition_legacy_5_modifier_scale
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_modifier
		scheme_discovery_chance_mult = 1.0
		scale = { value = scope:councillor.spymaster_disrupt_schemes_scheme_discovery_modifier divide = 200 }
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_court_of_shadows_modifier
		scheme_discovery_chance_mult = 1.0
		scale = { value = scope:councillor.spymaster_disrupt_schemes_court_of_shadows_scheme_discovery_modifier_scale divide = 200 }
	}

	council_owner_modifier = {
		name = task_disrupt_schemes_erudition_legacy_5_modifier
		scheme_discovery_chance_mult = 1.0
		scale = { value = scope:councillor.spymaster_disrupt_schemes_erudition_legacy_5_discovery_modifier_scale divide = 200 }
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_spymaster_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly = {
		liege = {
			if = {
				limit = {
					has_character_flag = no_spymaster_side_effects_first_month
				}
				remove_character_flag = no_spymaster_side_effects_first_month
			}
			else = {
				trigger_event = {
					on_action = task_disrupt_schemes_side_effects
					days = { 1 30 }
				}
			}
		}
	}

	ai_will_do = {
		value = 1 # Always a good backup
	}
}
kanikleios_task_support_schemes = {
	position = roman_councillor_kanikleios

	task_type = task_type_general
	task_progress = task_progress_infinite

	effect_desc = {
		desc = task_support_schemes_base_desc
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_support_schemes_legacy_bonus_desc
		}
		desc = task_support_schemes_success_chance_base_desc
		triggered_desc = {
			trigger = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			desc = task_support_schemes_success_chance_legacy_bonus_desc
		}
		desc = {
			desc = council_task_possible_side_effects
			triggered_desc = {
				trigger = {
					intrigue > mediocre_skill_rating
				}
				desc = task_support_schemes_learn_secret
			}
			triggered_desc = {
				trigger = {
					intrigue < high_skill_rating
				}
				desc = task_support_schemes_lose_piety
			}
			triggered_desc = {
				trigger = {
					intrigue < high_skill_rating
				}
				desc = task_support_schemes_lose_prestige
			}
			triggered_desc = {
				trigger = {
					intrigue < high_skill_rating
				}
				desc = task_support_schemes_fail_scheme
			}
		}
	}

	council_owner_modifier = {
		name = task_support_schemes_modifier
		hostile_scheme_power_add = 1.0
		scale = spymaster_espionage_modifier_final_scale
	}

	council_owner_modifier = {
		name = task_support_schemes_modifier
		owned_hostile_scheme_success_chance_add = 1.0
		scale = spymaster_espionage_success_chance_total
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_spymaster_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly = {
		if = {
			limit = {
				has_character_flag = no_spymaster_side_effects_first_month
			}
			remove_character_flag = no_spymaster_side_effects_first_month
		}
		else = {
			liege = {
				trigger_event = {
					on_action = task_support_schemes_side_effects
					days = { 1 30 }
				}
			}
		}
	}
}
kanikleios_task_find_secrets = {
	position = roman_councillor_kanikleios

	task_type = task_type_court
	task_progress = task_progress_percentage
	restart_on_finish = yes

	effect_desc = {
		desc = task_find_secrets_effect_desc
		desc = {
			desc = council_task_possible_side_effects
			desc = task_find_secrets_opinion_loss
			triggered_desc = {
				trigger = {
					exists = scope:target_character
					scope:target_character = {
						is_vassal_of = scope:councillor_liege
					}
				}
				desc = task_find_secrets_vassal_intimidation
			}
		}
	}

	progress = {
		value = 0
		add = {
			value = spymaster_find_secrets_base
			desc = SPYMASTER_PROGRESS_BASE
		}
		add = {
			value = scope:councillor.spymaster_find_secrets_monthly_increase
			desc = SCALED_COUNCILLOR_INTRIGUE_VALUE
		}
		# Relation Bonuses/Penalties
		if = {
			limit = {
				exists = scope:councillor_liege
			}
			if = { # Friend
				limit = {
					scope:councillor_liege = {
						has_relation_friend = scope:councillor
						NOT = { has_relation_best_friend = scope:councillor }
					}
				}
				add = {
					value = scope:councillor.spymaster_find_secrets_monthly_increase_friend_bonus
					desc = COUNCILLOR_IS_YOUR_FRIEND
				}
			}
			if = { # Best Friend
				limit = {
					scope:councillor_liege = {
						has_relation_best_friend = scope:councillor
					}
				}
				add = {
					value = scope:councillor.spymaster_find_secrets_monthly_increase_best_friend_bonus
					desc = COUNCILLOR_IS_YOUR_BEST_FRIEND
				}
			}
			if = { # Rival
				limit = {
					scope:councillor_liege = {
						has_relation_rival = scope:councillor
						NOT = { has_relation_nemesis = scope:councillor }
					}
				}
				add = {
					value = scope:councillor.spymaster_find_secrets_monthly_increase_rival_bonus
					desc = COUNCILLOR_IS_YOUR_RIVAL
				}
			}
			if = { # Nemesis
				limit = {
					scope:councillor_liege = {
						has_relation_nemesis = scope:councillor
					}
				}
				add = {
					value = scope:councillor.spymaster_find_secrets_monthly_increase_nemesis_bonus
					desc = COUNCILLOR_IS_YOUR_NEMESIS
				}
			}
			if = {
				limit = {
					scope:councillor_liege = { has_perk = digging_for_dirt_perk }
				}
				add = {
					value = scope:councillor.spymaster_find_secrets_perk_monthly_increase
					desc = ESPIONAGE_PERK_BONUS_VALUE
				}
			}
		}
		if = {
			limit = {
				exists = scope:councillor_liege.dynasty
				scope:councillor_liege.dynasty = { has_dynasty_perk = erudition_legacy_5 }
			}
			add = {
				value = scope:councillor_liege.spymaster_find_secrets_erudition_monthly_increase
				desc = ERUDITION_DYNASTY_PERK_BONUS_VALUE
			}
		}
		if = {
			limit = {
				exists = scope:target_character.cp:councillor_spymaster
				scope:target_character.cp:councillor_spymaster = {
					is_performing_council_task = task_disrupt_schemes
				}	
			}
			multiply = {
				value = scope:target_character.cp:councillor_spymaster.spymaster_find_secrets_disrupt_schemes_modifier_factor
				desc = TARGET_SPYMASTER_disrupt_schemes
			}
		}
		if = {
			limit = {
				exists = scope:target_character
				target_is_liege_or_above = scope:target_character
			}
			multiply = {
				value = 0.5
				desc = TARGET_IS_LIEGE_penalty
			}
		}
	}

	valid_target_court = {
		scope:target_character = {
			in_diplomatic_range = scope:councillor_liege
		}
		scope:target_character = {
			highest_held_title_tier >= tier_county
		}
	}

	potential_target_court = {
		scope:target_character = {
			is_alive = yes
			is_landed = yes
			highest_held_title_tier >= tier_county
			custom_description = {
				text = spymaster_will_not_find_secrets_at_own_court
				NOT = {
					this = scope:councillor
				}
			}
		}
	}

	on_finish_task_court = {
		scope:councillor_liege = {
			if = {
				limit = {
					scope:target_character = {
						OR = {
							spymaster_task_find_secrets_court_has_minor_secrets_trigger = yes
							spymaster_task_find_secrets_court_has_major_secrets_trigger = yes
						}
					}
				}
				random = {
					chance = scope:councillor.spymaster_find_secrets_secret_discovery_chance
					save_scope_value_as = {
						name = having_find_secrets_event
						value = yes
					}
					trigger_event = {
						on_action = task_find_secrets_outcome
					}
				}
			}
			if = {
				limit = {
					has_perk = truth_is_relative_perk
					NOT = { exists = scope:having_find_secrets_event }
				}
				random = {
					chance = scope:councillor.spymaster_find_secrets_secret_discovery_chance
					save_scope_value_as = {
						name = having_find_secrets_event
						value = yes
					}
					trigger_event = spymaster_task.0381 # Fabricate a Hook (if you have Truth is Relative)
				}
			}
			if = {
				limit = {
					NOT = { exists = scope:having_find_secrets_event }
				}
				trigger_event = spymaster_task.0399
			}
		}
	}

	on_start_task = {
		liege = {
			add_character_flag = {
				flag = no_spymaster_side_effects_first_month
				days = 30
			}
		}
	}

	on_monthly_court = {
		if = {
			limit = {
				has_character_flag = no_spymaster_side_effects_first_month
			}
			remove_character_flag = no_spymaster_side_effects_first_month
		}
		else = {
			trigger_event = {
				on_action = task_find_secrets_side_effects
				days = { 1 30 }
			}
		}
	}
}